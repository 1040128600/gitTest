<?xml version="1.0" encoding="UTF-8" ?> 
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-Mapper.dtd"> 
<mapper namespace="dao.BicycleStationDao">
<cache-ref namespace="dao.BicycleStationDao"/>
 <!-- 	public int getBicycleNumByMonth(String month);
	public int getRentTimesByMonth(String month);
	public String getRentTimeByMonth(String month);
	public int getRepairTimesByMonth(String month);
	public double getIncomeByMonth(String month);
	public double getRepairFeeByMonth(String month);
	
	public String getBicycleUseTime(Integer bicycle_Id);
	public int getBicycleRentTimes(Integer bicycle_Id);
	public int getBicycleRepairTimes(Integer bicycle_Id);
	public int getBicycleDeployTimes(Integer bicycle_Id);
	public String getBicycleRentTime(Integer bicycle_Id);
	public double getBicycleIncome(String month);
	public double getBicycleRepairFee(Integer bicycle_Id); -->
	
	
	<!-- 
	     select * from Bicycle_info where to_char(to_date(operator_time,'yyyy-mm-dd hh:mi:ss'),'yyyy-mm') = '2018-10'
		 select * from Bicycle_info where substr(operator_time,0, 7) = '2018-10'
		 select TO_NUMBER(to_date(return_Time,'yyyy-mm-dd hh24:mi:ss')-to_date(rent_Time,'yyyy-mm-dd hh24:mi:ss')) * 24 * 60*60 from Bicycle_record
		 
		     
	 -->

<!-- 对月的查询 -->
 <select id="getBicycleNumByMonth" resultType="int">
     select count(bicycle_Id) from Bicycle_info where substr(operator_time,0, 7) &lt;= #{month}
 </select>
 
 <select id="getRentTimesByMonth" resultType="int">
     select count(record_Id) from Bicycle_record where substr(rent_Time,0, 7) = #{month}
 </select>
 
 <select id="getRentTimeByMonth" resultType="int">
	select  sum(TO_NUMBER(to_date(return_Time,'yyyy-mm-dd hh24:mi:ss')-to_date(rent_Time,'yyyy-mm-dd hh24:mi:ss')) * 24 * 60*60) from Bicycle_record
	where substr(rent_Time,0, 7) = #{month}
 </select>
 
 <select id="getRepairTimesByMonth" resultType="int" >
     select count(record_Id) from Repair_record where substr(repair_Date,0, 7) = #{month}  
 </select>
 
 <select id="getIncomeByMonth" resultType="double">
     select sum(money) from Bicycle_record where substr(rent_Time,0, 7) = #{month}
 </select>
 
 <select id="getRepairFeeByMonth" resultType="double">
     select count(fee) from Repair_record  where substr(repair_Date,0, 7) = #{month}
 </select>
 
<!-- 对车的查询 -->
 <select id="getBicycleUseTime" resultType="int">
     select sum(TO_NUMBER(sysdate-to_date(operator_time,'yyyy-mm-dd hh24:mi:ss')) * 24 * 60*60) from Bicycle_info
     where bicycle_Id={bicycle_Id}
 </select>
 <select id="getBicycleRentTimes" resultType="int">
     select count(record_Id) from bicycle_record where bicycle_Id=#{bicycle_Id}
 </select>
 <select id="getBicycleRepairTimes" resultType="int">
     select count(record_Id) from Repair_record where  bicycle_Id=#{bicycle_Id}
 </select>
 <select id="getBicycleDeployTimes" resultType="int">
     select count(deploy_Id) from Bicycle_deploy where  bicycle_Id=#{bicycle_Id}
 </select>
 <select id="getBicycleRentTime" resultType="int">
     select sum(TO_NUMBER(to_date(return_Time,'yyyy-mm-dd hh24:mi:ss')-to_date(rent_Time,'yyyy-mm-dd hh24:mi:ss')) * 24 * 60*60) from Bicycle_record
     where bicycle_Id=#{bicycle_Id}
 </select>
 <select id="getBicycleIncome" resultType="double">
     select sum(money) from bicycle_record where  bicycle_Id=#{bicycle_Id}
 </select>
 <select id="getBicycleRepairFee" resultType="double">
     select sum(fee) from Repair_record where bicycle_Id=#{bicycle_Id}
 </select>
 </mapper>